{% extends "UcsEventFlowAnalyser::layout.html.twig" %}

{% macro display_events(events, title, visibility, name) %}
    <div class="span5 offset1">
        <h4 class="center">{{ title }} ({{ events|length|e }})</h4>
        <ul class="unstyled">
            {% if events|length > 0 %}
                {% for event in events %}
                    <li>
                        <a  rel="tooltip-left" 
                            title="See Event Flow" 
                            href="{{ asset('/events/event/' ~ visibility ~ '/' ~ name ~ '/' ~ event.event.type) }}">
                            <i class="icon-chevron-right"></i> {{ event.event.type|slice(14)|e }}
                        </a>
                    </li>
                {% endfor %}
            {% else %}
                none
            {% endif %}
        </ul>
    </div>
{% endmacro display_events %}

{% block title "UCS Event Flow Analyser: All Events" %}

{% block article %}
<article xmlns="http://www.w3.org/1999/html">
    <div class="row-fluid">
        {{ _self.display_events(parents, "parent", visibility, name) }}
        {{ _self.display_events(children, "children", visibility, name) }}
    </div>
    <hr/>
    <div class="row-fluid">
        {% for dir in ["output", "input"] %}
        <div class="span5 offset1">
            <h4 class="center">{{ dir|title }}</h4>
            <ul class="unstyled">
            {% for file in files %}
                {% if ( dir == file.direction ) %}
                <li>
                    <i class="icon-chevron-right"></i> 
                    <a href="{{ asset(file.document.uri) }}" >{{ file.document.name|title }}</a>
                </li>
                {% endif %}
            {% endfor %}
            </ul>
        </div>
        {% endfor %}
    </div>
    <hr/>
</article>
{% endblock %}
